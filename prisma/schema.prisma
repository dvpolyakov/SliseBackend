// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["interactiveTransactions"]
}

datasource db {
  provider          = "postgresql"
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

model Whitelist {
  id               String            @id @default(uuid())
  name             String
  contractAddress  String?
  twitter          String?
  twitterFollowers Int?
  discord          String?
  discordMembers   Int?
  size             Int
  chainType        ChainType         @default(ETHEREUM)
  whitelistMembers WhitelistMember[]
}

model WhitelistMember {
  id                    String    @id @default(uuid())
  address               String
  usdBalance            Float
  ethBalance            Float
  lastUpdate            DateTime  @default(now())
  whitelist             Whitelist @relation(fields: [whitelistId], references: [id])
  whitelistId           String
  tokens                Token[]
  totalTokens           Int
  tokenProcessed        Boolean   @default(true)
  tokenProcessedAttemps Int
}

model Token {
  id                String          @id @default(uuid())
  contractName      String
  contractAddress   String
  tokenType         TokenType       @default(UNKOWN)
  nftVersion        String?
  nftDescription    String          @db.Text
  balance           Int
  whitelistMember   WhitelistMember @relation(fields: [whitelistMemberId], references: [id])
  whitelistMemberId String
  items             Json            @db.JsonB
}

enum TokenType {
  ERC20
  ERC223
  ERC721
  ERC827
  ERC1155
  UNKOWN
}

enum ChainType {
  ETHEREUM
  POLYGON
  SOLANA
  UNKNOWN
}
